create or replace TABLE FIN_A.TRA.FACT_ACCOUNT_ANALYTICS (
	ACCOUNT_ID VARCHAR(100) NOT NULL COMMENT 'References DIM_ACCOUNT.account_id',
	ANALYTICS_DATE DATE NOT NULL COMMENT 'DATE of analytics snapshot',
	CURRENT_BALANCE NUMBER(18,2) NOT NULL COMMENT 'Closing balance on analytics date',
	AVG_DAILY_BALANCE NUMBER(18,2) NOT NULL COMMENT 'Average balance over last N days',
	TOTAL_CREDIT_30_D NUMBER(18,2) NOT NULL COMMENT 'Total credits in last 30 days',
	TOTAL_DEBIT_30_D NUMBER(18,2) NOT NULL COMMENT 'Total debits in last 30 days',
	TRANSACTION_COUNT_30_D NUMBER(10,0) NOT NULL COMMENT 'Number of transactions in last 30 days',
	ACCOUNT_STATUS VARCHAR(20) NOT NULL COMMENT 'ACTIVE/DORMANT/LOW_BALANCE',
	ACTN_CD VARCHAR(20) NOT NULL COMMENT 'ACTION CODE',
	primary key (ACCOUNT_ID, ANALYTICS_DATE)
);