CREATE OR REPLACE PROCEDURE FIN_A.RAW.DIM_CUSTOMER()
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS OWNER
AS '
    BEGIN
        INSERT INTO FIN_A.TRA.DIM_CUSTOMER
        SELECT R.CUSTOMER_ID,R.CUSTOMER_NAME,R.CUSTOMER_TYPE,R.DATE_OF_BIRTH,R.GENDER,R.PAN_NUMBER,R.AADHAAR_NUMBER,R.EMAIL,
            R.MOBILE_NUMBER,R.ADDRESS,R.CITY,R.STATE,R.COUNTRY,R.RISK_CATEGORY,
            CASE 
                WHEN C.CUSTOMER_ID IS NULL THEN ''I''
            END ACTN_CD
        FROM FIN_A.RAW.DIM_CUSTOMER R
        LEFT JOIN FIN_A.SCH.DIM_CUSTOMER C
        ON R.CUSTOMER_ID=C.CUSTOMER_ID;
    END
';