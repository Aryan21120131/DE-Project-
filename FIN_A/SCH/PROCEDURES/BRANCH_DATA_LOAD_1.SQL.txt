CREATE OR REPLACE PROCEDURE FIN_A.SCH.BRANCH_DATA_LOAD_1()
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS OWNER
AS '
    DECLARE
        I_CNT NUMBER DEFAULT 0;
        N_CNT NUMBER DEFAULT 0;
        U_CNT NUMBER DEFAULT 0;
        D_CNT NUMBER DEFAULT 0;
        R_CNT NUMBER DEFAULT 0;
    BEGIN
        LET I_smt VARCHAR := ''INSERT INTO FIN_A.SCH.DIM_BRANCH(BRANCH_CODE,BRANCH_NAME,CITY,STATE,COUNTRY,IFSC_CODE,BRANCH_STATUS)
                                SELECT BRANCH_CODE,BRANCH_NAME,CITY,STATE,COUNTRY,IFSC_CODE,\\''ACTIVE\\''
                                FROM FIN_A.TRA.DIM_BRANCH WHERE ACTN_CD=\\''I\\'''';

        EXECUTE IMMEDIATE :I_smt;
        
        I_CNT := SQLROWCOUNT;
        RETURN ''INSERT : '' || I_CNT || '' NO CHANGE : '' || N_CNT || '' UPDATE : '' || U_CNT || '' DELETE : '' || D_CNT || '' REINSERT : '' || R_CNT;
    END
';